@model Tund12.Models.Training

@{
    ViewData["Title"] = "Koolituse detailid";
}

<div class="container mt-4">
    <h1>@ViewData["Title"]</h1>
    <hr />

    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h3>@Model.Course?.Nimetus</h3>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-3">Keel</dt>
                        <dd class="col-sm-9">@Model.Course?.Keel</dd>

                        <dt class="col-sm-3">Tase</dt>
                        <dd class="col-sm-9">
                            <span class="badge bg-primary">@Model.Course?.Tase</span>
                        </dd>

                        <dt class="col-sm-3">Kirjeldus</dt>
                        <dd class="col-sm-9">@Model.Course?.Kirjeldus</dd>

                        <dt class="col-sm-3">Alguskuupäev</dt>
                        <dd class="col-sm-9">@Model.AlgusKuupaev.ToString("dd.MM.yyyy")</dd>

                        <dt class="col-sm-3">Lõppkuupäev</dt>
                        <dd class="col-sm-9">@Model.LoppKuupaev.ToString("dd.MM.yyyy")</dd>

                        <dt class="col-sm-3">Hind</dt>
                        <dd class="col-sm-9">@Model.Hind.ToString("C")</dd>

                        <dt class="col-sm-3">Vabad kohad</dt>
                        <dd class="col-sm-9">
                            @(Model.MaxOsalejaid - Model.Registrations.Count) / @Model.MaxOsalejaid
                        </dd>
                    </dl>

                    @if (User.IsInRole("Opilane"))
                    {
                        var isFull = Model.Registrations.Count >= Model.MaxOsalejaid;
                        if (!isFull)
                        {
                            <form asp-action="Register" asp-route-id="@Model.Id" method="post">
                                <button type="submit" class="btn btn-success">
                                    Registreeru sellele koolitusele
                                </button>
                            </form>
                        }
                        else
                        {
                            <div class="alert alert-danger">GRUPP TÄIS</div>
                        }
                    }
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5>Õpetaja</h5>
                </div>
                <div class="card-body text-center">
                    @if (!string.IsNullOrEmpty(Model.Teacher?.FotoPath))
                    {
                        <img src="~/images/@Model.Teacher.FotoPath" alt="@Model.Teacher.Nimi"
                            class="img-fluid rounded-circle mb-3" style="max-width: 150px;">
                    }
                    <h5>@Model.Teacher?.Nimi</h5>
                    <p class="text-muted">@Model.Teacher?.Kvalifikatsioon</p>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-3">
        <a asp-action="Index" class="btn btn-secondary">Tagasi nimekirja</a>
    </div>
</div>